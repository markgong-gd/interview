> 使用域名访问

1. 域名解析

浏览器发现访问地址是域名，会通过DNS域名解析器翻译成TCP/IP协议里的ip地址

    - DNS域名解析
    域名解析是一个复杂过程，如果每次访问都需要解析，那将会影响访问性能。于是就有了缓存。

    域名信息缓存
    1. 浏览器先查看自己有没有
    （没有）
    2. 向操作系统要；
    （没有）
    3. 检查本机域名解析文件hosts，windows系统，一般在C:\WINDOWS\system32\drivers\etc\hosts目录下
    （没有）
    4. 请求DNS服务器进行ip解析
        DNS解析域名：
            域名是一个有层次的结构，以www.baidu.com为例。
            com：顶级域名，在这层中可查找到二级域名
            baidu: 二级域名，在这层中可以查找到主机名了
            www: 主机名，通常用来表示主机用途
            局部DNS服务器(系统配置DNS服务器) ===> 根域名服务器 ===> 顶级域名服务器 ===> 域名服务器

2. 建立 TCP 连接

三次握手建立连接

    - 第一次握手
        客户端发送请求报文。该报文中包含自身数据通讯初始序列号，进入SYK-SENT状态
    - 第二次握手
        服务端允许建立连接，发送应答报文。该报文同样当上自身数据通讯初始序列号，进入SYK-RECEIVED状态
    - 第三次握手
        客户端收到应答后，发送确认收到报文。进入ESTABLISHED状态。
    
    建立连接两次握手就可以了，为什么是三次？
    为了防止失效的连接请求报文突然传到服务端。例如：客户端发送一次请求A，由于网络延时问题，服务端没有收到，客户端长时间未收到答应，再次发送请求B，这时服务端响应B，建立连接，完成一次数据传输，关闭连接，这时服务端又收到请求A，响应了，但是这时客户端是关闭的。

https

    - 

3. 渲染页面

发送页面数据请求，服务端返回页面（这里服务端寻找资源过程比较复杂之后再说），浏览器获取响应报文

    url                     发送http请求
    ==> HTML                经过parse解析
    ==> DOM                 添加css属性到DOM树, 获取到CSSOM树
    ==> DOM with CSS        解析CSSOM树，获取到一个具有几何位置的DOM
    ==> DOM with position   结果render，渲染出页面
    ==> Bitmap

4. 断开连接

四次挥手断开连接

    - 第一次挥手
        客户端认为数据发送完毕，会向服务器发送关闭连接请求
    - 第二次挥手
        服务器收到关闭连接请求，响应客户端发送ACK包，连接关闭，处于不在接收客户端请求状态
    - 第三次挥手
        服务器如果有未发完数据，会继续发送，完毕后通知客户端关闭连接
    - 第四次挥手
        客户端收到关闭应答后，发送确认请求，进入TIME_WAIT等待阶段（持续2MSL，报文在网络中最大段生存时间），如果该时间段内没有收到服务端请求，客户端关闭。服务端收到客户端确认请求后关闭。
    
    为什么有TIME_WAIT阶段，等待2MSL？
    为了保证服务器正常收到关闭确认请求。如果服务器没有正常收到，服务器无法正常关闭。